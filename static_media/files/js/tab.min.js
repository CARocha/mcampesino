/*
|------------------------------------------|
| MelonHTML5 - All in One Tab              |
|------------------------------------------|
| @author:  Lee Le (lee@melonhtml5.com)    |
| @version: 1.01 (03 Oct 2012)             |
| @website: www.melonhtml5.com             |
|------------------------------------------|
*/

Tab={_config:{position:"top",autohide:!0,animation:"slide-r",speed:500,shortcut:!0,indicator:!0,keyboard:!1,slideshow:!1},_identifier:"melonhtml5_tab",_slideshow_speed:3E3,_tab_menu_speed:200,_current_tab:null,_tabs:null,_tab_created:!1,init:function(){Tab._cache_elements();Tab._current_tab=Tab._tabs.eq(0);Tab._tabs.each(function(){var a=$(this),b=a.children("div.menu"),c=a.children("div.main"),e=b.children("a");b.addClass(Tab._config.position);$("<span>").addClass("right").appendTo(b).mousedown(Tab.Events.scrollRight).mouseup(Tab.Events.scrollStop).mouseleave(Tab.Events.scrollStop);
var d=$("<span>").addClass("shortcut").appendTo(b).click(Tab.Events.shortcutClick);Tab._config.shortcut?d.show():d.hide();var h=$("<div>").css("display","inline-block").append(e),d=$("<div>").addClass("scroller").append(h).width(1E4),f=$("<div>").addClass("scroll_container").append(d).appendTo(b);d.width(h.width());e.appendTo(d);h.remove();f.width(f.width());$("<span>").addClass("left").appendTo(b).mousedown(Tab.Events.scrollLeft).mouseup(Tab.Events.scrollStop).mouseleave(Tab.Events.scrollStop);$("<div>").addClass("indicator").width(100/
e.length+"%").css("transition","left "+Tab._config.speed/1E3+"s").appendTo(a);h=b.find("a.active");h.length?c.children("div").eq(h.index()).addClass("active"):(b.find("a:first").addClass("active"),c.children("div:first").addClass("active"));Tab._updateScrollArrow(d);e.click(Tab.Events.tabClick);a.mouseenter(Tab.Events.mouseEnter).mouseleave(Tab.Events.mouseLeave);Tab._config.autohide&&a.addClass("autohide");setTimeout(function(){b.css("visibility","visible")},300)});$(window).resize(Tab.Events.windowResize);
$(document).keydown(Tab.Events.keydown).click(Tab.Events.documentClick);Tab._slideshow();Tab._tab_created=!0},setOptions:function(a){var b=!1;"undefined"!==typeof a.position&&a.position!==Tab._config.position&&(b=!0);var c=!1;"undefined"!==typeof a.autohide&&a.autohide!==Tab._config.autohide&&(c=!0);var e=!1;"undefined"!==typeof a.shortcut&&a.shortcut!==Tab._config.shortcut&&(e=!0);var d=!1;"undefined"!==typeof a.speed&&a.speed!==Tab._config.speed&&(d=!0);Tab._config.position="undefined"===typeof a.position?
Tab._config.position:a.position;Tab._config.autohide="undefined"===typeof a.autohide?Tab._config.autohide:a.autohide;Tab._config.animation="undefined"===typeof a.animation?Tab._config.animation:a.animation;Tab._config.speed="undefined"===typeof a.speed?Tab._config.speed:a.speed;Tab._config.shortcut="undefined"===typeof a.shortcut?Tab._config.shortcut:a.shortcut;Tab._config.indicator="undefined"===typeof a.indicator?Tab._config.indicator:a.indicator;Tab._config.keyboard="undefined"===typeof a.keyboard?
Tab._config.keyboard:a.keyboard;Tab._config.slideshow="undefined"===typeof a.slideshow?Tab._config.slideshow:a.slideshow;Tab._tab_created&&((b||c)&&Tab._tabs.each(function(){Tab._config.autohide?$(this).addClass("autohide"):$(this).removeClass("autohide");if(b){var a=$(this).children("div.menu");"top"===Tab._config.position?a.removeClass("bottom").addClass("top"):a.removeClass("top").addClass("bottom")}}),e&&(Tab._config.shortcut?Tab._tabs.find("span.shortcut").show():Tab._tabs.find("span.shortcut").hide()),
d&&Tab._tabs.find("div.indicator").css("transition","left "+Tab._config.speed/1E3+"s"))},_cache_elements:function(){Tab._tabs=$("div."+Tab._identifier)},_moveToTab:function(a,b){if(a.hasClass("active")||a.hasClass("disabled"))return!1;var c=a.index(),e=a.parents("div."+Tab._identifier),d=a.parents("div.menu"),h=d.next("div.main"),f=d.children("span.left"),i=d.children("span.right");if(!0===e.data("animating"))return!1;e.data("animating",!0);if(!f.hasClass("disabled")&&a.offset().left<f.offset().left+
f.outerWidth()){var f=d.find("div.scroller"),g=0;f.children().each(function(b,c){if(c===a.get(0))return!1;g+=$(this).outerWidth()});f.css("margin-left",-1*g);Tab._updateScrollArrow(f,-1*g)}else!a.hasClass("disabled")&&a.offset().left+a.outerWidth()>i.offset().left&&(f=d.find("div.scroller"),g=0,i=f.parent(),f.children().each(function(b,c){if(c===a.get(0))return!1;g+=$(this).outerWidth()}),g+=a.outerWidth(),g-=i.width(),f.css("margin-left",-1*g),Tab._updateScrollArrow(f,-1*g));d.find("a.active").removeClass("active");
a.addClass("active");setTimeout(function(){var b=h.children(".active"),d=h.children("div").eq(c);switch(Tab._config.animation){case "slide-h":var f=b.width();b.width(f);d.width(f).css("left",f).show();b.css("transition","left "+Tab._config.speed/1E3+"s");d.css("transition","left "+Tab._config.speed/1E3+"s");$(document.body).width();b.css("left",-1*f);d.css("left",0);setTimeout(function(){b.removeClass("active").removeAttr("style");d.addClass("active").removeAttr("style");e.data("animating",!1)},Tab._config.speed);
break;case "slide-v":f=b.height();b.height(f);d.height(f).css("top",-1*f).show();b.css("transition","top "+Tab._config.speed/1E3+"s");d.css("transition","top "+Tab._config.speed/1E3+"s");$(document.body).width();b.css("top",f);d.css("top",0);setTimeout(function(){b.removeClass("active").removeAttr("style");d.addClass("active").removeAttr("style");e.data("animating",!1)},Tab._config.speed);break;case "slide-t":case "slide-b":d.addClass("active");b.css("z-index",20).css("transition","all "+Tab._config.speed/
1E3+"s ease-in");$(document.body).width();b.css("transform","scale(0.5)");setTimeout(function(){var a=b.height();"slide-t"===Tab._config.animation?b.css({top:-2*a,bottom:2*a}):b.css({top:2*a,bottom:-2*a});setTimeout(function(){b.removeClass("active").removeAttr("style");e.data("animating",!1)},Tab._config.speed)},Tab._config.speed+200);break;case "slide-r":case "slide-l":d.addClass("active");b.css("z-index",20).css("transition","all "+Tab._config.speed/1E3+"s ease-in");$(document.body).width();b.css("transform",
"scale(0.5)");setTimeout(function(){var a=b.width();"slide-r"===Tab._config.animation?b.css({left:2*a,right:-2*a}):b.css({left:-2*a,right:2*a});setTimeout(function(){b.removeClass("active").removeAttr("style");e.data("animating",!1)},Tab._config.speed)},Tab._config.speed+200);break;case "blind-h":f=b.width();d.css({left:f,"z-index":20,transition:"left "+Tab._config.speed/1E3+"s"}).width(f).show();$(document.body).width();d.css("left",0);setTimeout(function(){d.addClass("active").removeAttr("style");
b.removeClass("active").removeAttr("style");e.data("animating",!1)},Tab._config.speed);break;case "blind-v":f=b.height();d.css({top:-1*f,"z-index":20,transition:"top "+Tab._config.speed/1E3+"s"}).height(f).show();$(document.body).width();d.css("top",0);setTimeout(function(){d.addClass("active").removeAttr("style");b.removeClass("active").removeAttr("style");e.data("animating",!1)},Tab._config.speed);break;case "fade":b.css({"z-index":20,opacity:1,transition:"all "+Tab._config.speed/1E3+"s"});d.show();
$(document.body).width();b.css("opacity",0).css("transform","scale(2)");setTimeout(function(){d.addClass("active").removeAttr("style");b.removeClass("active").removeAttr("style");e.data("animating",!1)},Tab._config.speed);break;case "rotate":d.addClass("active");b.css("z-index",20).css("transition","all "+Tab._config.speed/1E3+"s").width(b.width()).height(b.height());$(document.body).width();b.width(0).css({top:"auto",right:-100,bottom:"auto",left:"auto",transform:"rotateZ(360deg)"});setTimeout(function(){b.removeClass("active").removeAttr("style");
e.data("animating",!1)},Tab._config.speed);break;default:b.removeClass("active"),d.addClass("active"),e.data("animating",!1)}Tab._config.indicator&&Tab._updateIndicator(a)},b?200:0);return!0},_slideshow:function(){setTimeout(function(){Tab._config.slideshow&&Tab._tabs.each(function(a,b){var c=function(a){if(!a.length)return!1;var b=a.next();return b.length?b.hasClass("disabled")?c(b):b:b=a.parent().children().first()},e=$(b).children("div.menu").find("a.active");(e=c(e))&&Tab._moveToTab(e,!0)});Tab._slideshow()},
Tab._slideshow_speed)},_updateIndicator:function(a){var b=a.index(),c=a.parents("div."+Tab._identifier).children("div.indicator"),a=a.parent().children().length;clearTimeout(c.data("timeout"));c.show();c.css("left",100/a*b+"%");setTimeout(function(){var a=setTimeout(function(){c.fadeOut()},2E3);c.data("timeout",a)},Tab._config.speed)},_updateScrollArrow:function(a,b){var c=a.data("left_arrow");c||(c=a.parents("div.menu:first").children("span.left"),a.data("left_arrow",c));var e=a.data("right_arrow");
e||(e=a.parents("div.menu:first").children("span.right"),a.data("right_arrow",e));"undefined"===typeof b&&(b=parseInt(a.css("margin-left"),10));0<=b?c.addClass("disabled"):c.removeClass("disabled");var c=a.parent().width(),d=a.width();c>=d?e.addClass("disabled"):-1*b+c>=d?e.addClass("disabled"):e.removeClass("disabled")},Events:{_window_resize_timeout:null,_scroll_timeout:null,tabClick:function(a){a.preventDefault();Tab._moveToTab($(this),!1)},documentClick:function(a){a=$(a.target);(!a.parent().length||
!a.parent().hasClass("menu")||!a.hasClass("shortcut")&&!a.hasClass("shortcut_menu"))&&Tab._tabs.find("div.shortcut_menu").removeClass("active")},keydown:function(a){if(Tab._config.keyboard&&Tab._current_tab)switch(a.which){case 37:case 39:if(!Tab._current_tab.data("animating")){var b=function(c){if(!c.length)return!1;c=37===a.which?c.prev():c.next();return c.length?c.hasClass("disabled")?b(c):c:!1},c=Tab._current_tab.children("div.menu").find("a.active");(c=b(c))&&Tab._moveToTab(c,!0)}}},windowResize:function(){clearTimeout(Tab.Events._window_resize_timeout);
Tab.Events._window_resize_timeout=setTimeout(function(){Tab._tabs.each(function(){var a=$(this).find("div.scroller");Tab._updateScrollArrow(a)})},100)},mouseEnter:function(){Tab._current_tab=$(this)},mouseLeave:function(){Tab._config.autohide&&$(this).children("div.menu").children("div.shortcut_menu").removeClass("active")},scrollLeft:function(){var a=$(this);if(a.hasClass("disabled"))return!1;var b=a.data("scroller");b||(b=a.parents("div.menu:first").find("div.scroller"),a.data("scroller",b));var c=
parseInt(b.css("margin-left"),10)+50,c=Math.min(c,0);b.css("margin-left",c);Tab._updateScrollArrow(b,c);Tab.Events._scroll_timeout=setTimeout(function(){a.mousedown()},100)},scrollRight:function(){var a=$(this);if(a.hasClass("disabled"))return!1;var b=a.data("scroller");b||(b=a.parents("div.menu:first").find("div.scroller"),a.data("scroller",b));var c=parseInt(b.css("margin-left"),10)-50,c=Math.max(c,-1*(b.width()-b.parent().width()));b.css("margin-left",c);Tab._updateScrollArrow(b,c);Tab.Events._scroll_timeout=
setTimeout(function(){a.mousedown()},100)},scrollStop:function(){clearTimeout(Tab.Events._scroll_timeout)},shortcutClick:function(){var a=$(this).parents("div.menu:first"),b=a.children("div.shortcut_menu");b.length?b.toggleClass("active"):(b=$("<div>").addClass("shortcut_menu").appendTo(a),a.find("a").each(function(){var a=$(this),e=$("<div>").text(a.text()).appendTo(b).click(function(){a.click()});a.hasClass("disabled")&&e.addClass("disabled")}),$(document.body).width(),b.addClass("active"))}}};
$(document).ready(Tab.init);